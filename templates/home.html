{% extends 'index.html' %}
{% use 'components/header.html' %}
{% use 'components/footer.html' %}

{% block stylesheets %}
<link rel="stylesheet" href="{{base_url}}/public/assets/css/header.css">
<link rel="stylesheet" href="{{base_url}}/public/assets/css/footer.css">
<link rel="stylesheet" href="{{base_url}}/public/assets/css/barSearch.css">
<link rel="stylesheet" href="{{base_url}}/public/assets/css/flickity.css">
<link rel="stylesheet" href="{{base_url}}/public/assets/css/carousel.css">
{% endblock %}

{% block body %}
{% block header %}{{ parent() }}{% endblock %}
<main>
    <form action="{{ base_url }}/search" method="GET" class="form">
        <input type="search" name="query" class="form-input" value="{{ query }}" placeholder="O que você está procurando?" />
        <button type="submit">Pesquisar</button>
    </form>
    <div class="gallery js-flickity">
        <div class="gallery-cell" id="img1"></div>
        <div class="gallery-cell" id="img2"></div>
    </div>
    <div class="category">
        <h1>
            {% if query %}
            Resultado para {{ query |upper }}
            {% else %}{% if title %}Resultado para {{ title |upper }}{% else %}MAIS POPULARES{% endif %}{% endif %}</h1>
        <hr>
        <div class="gallery js-flickity books">
            {% for obj in objs %}
            <div class="gallery-cell card is-selected">
                <div>
                    <img src="{{attribute(obj, 'getImage')}}" alt="{{attribute(obj, 'getName')}}">
                    <div class="details">
                        <p class="title">{{attribute(obj, 'getName')}}</p>
                        <p class="subtitle">{{attribute(obj, 'getAuthor')}}</p>
                        <p class="price">R$ {{attribute(obj, 'getPrice')}}</p>
                        <button class="btn-default">Comprar</button>
                    </div>
                </div>
            </div>
            {% endfor %}
            {%if objs | length == 0 %}
            <div>
                <p class="not-found">Nenhum livro encontrado.</p>
            </div>
            {% endif %}
        </div>
    </div>
</main>
{% block footer %}{{ parent() }}{% endblock %}
{% endblock%}

{% block javascripts %}
<script src="{{base_url}}/public/assets/js/flickity.pkgd.min.js"></script>
<script>
    $('.gallery').flickity({
        cellAlign: 'left',
        contain: true
    });
</script>
{% endblock %}